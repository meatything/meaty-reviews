javascript:(function(){const MAX_REVIEWS=250;const SCROLL_DELAY=800;const MAX_SCROLL_ATTEMPTS=50;function getExtensionName(){const titleEl=document.querySelector('h1');if(titleEl)return titleEl.textContent.trim();return document.title.replace(' - Chrome Web Store','').trim()||'Unknown Extension'}function parseStarRating(reviewEl){const ratingEl=reviewEl.querySelector('[aria-label*="star"],[aria-label*="Star"]');if(ratingEl){const match=ratingEl.getAttribute('aria-label').match(/(\d+)/);if(match)return parseInt(match[1],10)}const allAriaLabels=reviewEl.querySelectorAll('[aria-label]');for(const el of allAriaLabels){const label=el.getAttribute('aria-label');const match=label.match(/^(\d)\s*star/i)||label.match(/rating[:\s]*(\d)/i);if(match){const rating=parseInt(match[1],10);if(rating>=1&&rating<=5)return rating}}return null}function parseDate(reviewEl){const textNodes=reviewEl.querySelectorAll('span,div,time');for(const node of textNodes){const text=node.textContent.trim();if(/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\s+\d{1,2},?\s+\d{4}$/i.test(text))return text;if(/^\d{1,2}\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\s+\d{4}$/i.test(text))return text;if(/^\d+\s+(day|week|month|year)s?\s+ago$/i.test(text))return text}return null}function parseReviewText(reviewEl){let longestText='';const textContainers=reviewEl.querySelectorAll('p,div,span');for(const container of textContainers){if(container.closest('[aria-label],button,[role="button"]'))continue;const text=container.textContent.trim();if(text.length<10)continue;if(/^\d+\s*(star|rating|day|week|month|year)/i.test(text))continue;if(/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)/i.test(text)&&text.length<20)continue;if(text.length>longestText.length)longestText=text}return longestText||null}function findReviewElements(){const candidates=[];const starElements=document.querySelectorAll('[aria-label*="star" i],[aria-label*="rating" i]');for(const starEl of starElements){let container=starEl.parentElement;for(let i=0;i<4&&container;i++){const text=container.textContent;if(text.length>50&&text.length<5000){if(!candidates.includes(container))candidates.push(container);break}container=container.parentElement}}const uniqueReviews=candidates.filter(el=>!candidates.some(other=>other!==el&&other.contains(el)));return uniqueReviews}function extractReviews(){const reviewElements=findReviewElements();const reviews=[];const seenTexts=new Set();for(const reviewEl of reviewElements){const stars=parseStarRating(reviewEl);const date=parseDate(reviewEl);const text=parseReviewText(reviewEl);if(!text||text.length<10)continue;const textKey=text.substring(0,100);if(seenTexts.has(textKey))continue;seenTexts.add(textKey);reviews.push({stars,date,text});if(reviews.length>=MAX_REVIEWS)break}return reviews}async function scrollAndCollect(){let allReviews=[];let scrollAttempts=0;let previousCount=0;let noNewReviewsCount=0;const statusDiv=document.createElement('div');statusDiv.style.cssText='position:fixed;top:10px;right:10px;background:#1a73e8;color:white;padding:12px 20px;border-radius:8px;z-index:999999;font-family:system-ui;font-size:14px;box-shadow:0 4px 12px rgba(0,0,0,0.3)';statusDiv.textContent='Extracting reviews... 0/250';document.body.appendChild(statusDiv);while(scrollAttempts<MAX_SCROLL_ATTEMPTS&&allReviews.length<MAX_REVIEWS){const currentReviews=extractReviews();for(const review of currentReviews){const isDuplicate=allReviews.some(r=>r.text.substring(0,100)===review.text.substring(0,100));if(!isDuplicate)allReviews.push(review)}statusDiv.textContent=`Extracting reviews... ${allReviews.length}/250`;if(allReviews.length>=MAX_REVIEWS)break;if(allReviews.length===previousCount){noNewReviewsCount++;if(noNewReviewsCount>=3)break}else{noNewReviewsCount=0}previousCount=allReviews.length;window.scrollBy(0,window.innerHeight);await new Promise(r=>setTimeout(r,SCROLL_DELAY));scrollAttempts++}statusDiv.textContent=`Done! Extracted ${allReviews.length} reviews. Downloading...`;const data={extensionName:getExtensionName(),extractedAt:new Date().toISOString(),reviewCount:allReviews.length,reviews:allReviews.slice(0,MAX_REVIEWS)};const json=JSON.stringify(data,null,2);const blob=new Blob([json],{type:'application/json'});const url=URL.createObjectURL(blob);const filename=`reviews-${data.extensionName.replace(/[^a-z0-9]/gi,'-').toLowerCase()}-${Date.now()}.json`;const a=document.createElement('a');a.href=url;a.download=filename;a.click();URL.revokeObjectURL(url);setTimeout(()=>{statusDiv.textContent=`Downloaded ${allReviews.length} reviews!`;statusDiv.style.background='#1e8e3e';setTimeout(()=>statusDiv.remove(),3000)},500)}scrollAndCollect()})();

javascript:(function(){const MAX_REVIEWS=250;const CLICK_DELAY=1500;const MAX_CLICKS=100;function getExtensionName(){const titleEl=document.querySelector('h1');if(titleEl)return titleEl.textContent.trim();return document.title.replace(' - Chrome Web Store','').trim()||'Unknown Extension'}function parseStarRating(reviewEl){const ratingEl=reviewEl.querySelector('[aria-label*="star"],[aria-label*="Star"]');if(ratingEl){const match=ratingEl.getAttribute('aria-label').match(/(\d+)/);if(match)return parseInt(match[1],10)}const allAriaLabels=reviewEl.querySelectorAll('[aria-label]');for(const el of allAriaLabels){const label=el.getAttribute('aria-label');const match=label.match(/^(\d)\s*star/i)||label.match(/rating[:\s]*(\d)/i);if(match){const rating=parseInt(match[1],10);if(rating>=1&&rating<=5)return rating}}return null}function parseDate(reviewEl){const textNodes=reviewEl.querySelectorAll('span,div,time');for(const node of textNodes){const text=node.textContent.trim();if(/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\s+\d{1,2},?\s+\d{4}$/i.test(text))return text;if(/^\d{1,2}\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\s+\d{4}$/i.test(text))return text;if(/^\d+\s+(day|week|month|year)s?\s+ago$/i.test(text))return text}return null}function parseReviewText(reviewEl){let longestText='';const textContainers=reviewEl.querySelectorAll('p,div,span');for(const container of textContainers){if(container.closest('[aria-label],button,[role="button"]'))continue;const text=container.textContent.trim();if(text.length<10)continue;if(/^\d+\s*(star|rating|day|week|month|year)/i.test(text))continue;if(/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)/i.test(text)&&text.length<20)continue;if(text.length>longestText.length)longestText=text}return longestText||null}function findReviewElements(){const candidates=[];const starElements=document.querySelectorAll('[aria-label*="star" i],[aria-label*="rating" i]');for(const starEl of starElements){let container=starEl.parentElement;for(let i=0;i<4&&container;i++){const text=container.textContent;if(text.length>50&&text.length<5000){if(!candidates.includes(container))candidates.push(container);break}container=container.parentElement}}const uniqueReviews=candidates.filter(el=>!candidates.some(other=>other!==el&&other.contains(el)));return uniqueReviews}function extractReviews(){const reviewElements=findReviewElements();const reviews=[];const seenTexts=new Set();for(const reviewEl of reviewElements){const stars=parseStarRating(reviewEl);const date=parseDate(reviewEl);const text=parseReviewText(reviewEl);if(!text||text.length<10)continue;const textKey=text.substring(0,100);if(seenTexts.has(textKey))continue;seenTexts.add(textKey);reviews.push({stars,date,text});if(reviews.length>=MAX_REVIEWS)break}return reviews}function findLoadMoreButton(){const buttons=document.querySelectorAll('button');for(const btn of buttons){const text=btn.textContent.toLowerCase();if(text.includes('load more')||text.includes('show more')||text.includes('more reviews'))return btn}const spans=document.querySelectorAll('span,div');for(const el of spans){if(el.children.length===0){const text=el.textContent.toLowerCase();if(text==='load more'||text==='show more'){const clickable=el.closest('button,[role="button"],[tabindex]');if(clickable)return clickable}}}return null}async function clickAndCollect(){let clicks=0;let previousCount=0;let noNewCount=0;const statusDiv=document.createElement('div');statusDiv.style.cssText='position:fixed;top:10px;right:10px;background:#1a73e8;color:white;padding:12px 20px;border-radius:8px;z-index:999999;font-family:system-ui;font-size:14px;box-shadow:0 4px 12px rgba(0,0,0,0.3)';statusDiv.textContent='Extracting reviews... 0/250';document.body.appendChild(statusDiv);while(clicks<MAX_CLICKS){const currentReviews=extractReviews();statusDiv.textContent=`Extracting reviews... ${currentReviews.length}/250`;if(currentReviews.length>=MAX_REVIEWS)break;if(currentReviews.length===previousCount){noNewCount++;if(noNewCount>=3)break}else{noNewCount=0}previousCount=currentReviews.length;const loadMoreBtn=findLoadMoreButton();if(!loadMoreBtn){statusDiv.textContent=`No more reviews to load. Found ${currentReviews.length}`;await new Promise(r=>setTimeout(r,500));break}loadMoreBtn.scrollIntoView({behavior:'smooth',block:'center'});await new Promise(r=>setTimeout(r,300));loadMoreBtn.click();clicks++;await new Promise(r=>setTimeout(r,CLICK_DELAY))}const allReviews=extractReviews().slice(0,MAX_REVIEWS);statusDiv.textContent=`Done! Extracted ${allReviews.length} reviews. Downloading...`;const data={extensionName:getExtensionName(),extractedAt:new Date().toISOString(),reviewCount:allReviews.length,reviews:allReviews};const json=JSON.stringify(data,null,2);const blob=new Blob([json],{type:'application/json'});const url=URL.createObjectURL(blob);const filename=`reviews-${data.extensionName.replace(/[^a-z0-9]/gi,'-').toLowerCase()}-${Date.now()}.json`;const a=document.createElement('a');a.href=url;a.download=filename;a.click();URL.revokeObjectURL(url);setTimeout(()=>{statusDiv.textContent=`Downloaded ${allReviews.length} reviews!`;statusDiv.style.background='#1e8e3e';setTimeout(()=>statusDiv.remove(),3000)},500)}clickAndCollect()})();
